#include <stdio.h>
#include<stdlib.h>
#include <inttypes.h>

int64_t SHL(unsigned char* data, int length) {
    int64_t  hash = 0x2FD2B4;
    for(int i=0;i<length;i++) {
        hash = hash ^ data[i];
        hash = hash * 0x66EC73;
    }
    return hash;
}

void main() {
    
    unsigned char* data = (unsigned char *) malloc(60570);
    FILE *ptr = fopen("output.png", "rb");
    fread(data,1,60570,ptr);
    fclose(ptr);
    
    data[0x1000*0+10] = 7;
    data[0x1000*13+10] = 12;
    
    unsigned char p1[][3] = {{54, 61, 61},{61, 54, 61},{61, 61, 54}};
    unsigned char p2[][4] = {
                            {56, 58, 59, 80},
                            {56, 59, 58, 80},
                            {57, 61, 61, 78},
                            {58, 56, 59, 80},
                            {58, 59, 56, 80},
                            {58, 59, 60, 84},
                            {58, 60, 59, 84},
                            {59, 56, 58, 80},
                            {59, 58, 56, 80},
                            {59, 58, 60, 84},
                            {59, 59, 61, 84},
                            {59, 60, 58, 84},
                            {59, 61, 59, 84},
                            {60, 58, 59, 84},
                            {60, 59, 58, 84},
                            {61, 57, 61, 78},
                            {61, 59, 59, 84},
                            {61, 61, 57, 78}
                            };
    unsigned char p3[] = {77,78,79,80,81,82,83,84,85,86};
    
    unsigned char p4[][4] = {
                        {77, 79, 80, 35},
                        {77, 80, 79, 35},
                        {77, 81, 81, 34},
                        {77, 81, 84, 41},
                        {77, 84, 81, 41},
                        {78, 78, 86, 39},
                        {78, 86, 78, 39},
                        {79, 77, 80, 35},
                        {79, 80, 77, 35},
                        {79, 82, 82, 36},
                        {79, 83, 85, 38},
                        {79, 85, 83, 38},
                        {80, 77, 79, 35},
                        {80, 79, 77, 35},
                        {80, 81, 81, 37},
                        {80, 82, 84, 39},
                        {80, 84, 82, 39},
                        {81, 77, 81, 34},
                        {81, 77, 84, 41},
                        {81, 80, 81, 37},
                        {81, 81, 77, 34},
                        {81, 81, 80, 37},
                        {81, 82, 83, 35},
                        {81, 83, 82, 35},
                        {81, 84, 77, 41},
                        {82, 79, 82, 36},
                        {82, 80, 84, 39},
                        {82, 81, 83, 35},
                        {82, 82, 79, 36},
                        {82, 83, 81, 35},
                        {82, 84, 80, 39},
                        {83, 79, 85, 38},
                        {83, 81, 82, 35},
                        {83, 82, 81, 35},
                        {83, 85, 79, 38},
                        {84, 77, 81, 41},
                        {84, 80, 82, 39},
                        {84, 81, 77, 41},
                        {84, 82, 80, 39},
                        {85, 79, 83, 38},
                        {85, 83, 79, 38},
                        {86, 78, 78, 39}
                            };
    
    printf("%d Combinations\n", (3*18*10*42));
    int counter = 0;
    for(int i1=0;i1<3;i1++) {
        data[0x1000*1+10] = p1[i1][0];
        data[0x1000*2+10] = p1[i1][1];
        data[0x1000*3+10] = p1[i1][2];
        for(int i2=0;i2<18;i2++) {
            data[0x1000*4+10] = p2[i2][0];
            data[0x1000*5+10] = p2[i2][1];
            data[0x1000*6+10] = p2[i2][2];
            data[0x1000*7+10] = p2[i2][3];
            for(int i3=0;i3<10;i3++) {
                data[0x1000*8+10] = p3[i3];
                for(int i4=0;i4<42;i4++) {
                    data[0x1000*9+10] = p4[i4][0];
                    data[0x1000*10+10] = p4[i4][1];
                    data[0x1000*11+10] = p4[i4][2];
                    data[0x1000*12+10] = p4[i4][3];
                    int64_t hash = SHL(data, 60570);
                    char c1 = (char)((hash-0x7D)&0xFF);
                    char c2 = (char)(((hash>>8)+0x7C)&0xFF);
                    if(c1 == 'F' && c2 == 'l') { // parts of the constraints needed to solve
                        printf("%05d/%05d - %llx %lld\n",counter,(3*18*10*42), hash, hash);
                        for(int i=0;i<14;i++) {
                            printf("\t%d,\n", data[0x1000*i+10]);
                        }
                    }
                    counter++;
                }
            }
        }
    }
}