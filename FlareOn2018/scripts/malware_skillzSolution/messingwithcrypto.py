import base64
import hashlib
from Crypto import Random
from Crypto.Cipher import AES

#https://stackoverflow.com/questions/12524994/encrypt-decrypt-using-pycrypto-aes-256
class AESCipher(object):
    def __init__(self, key, iv): 
        self.bs = 32
        self.key = key
        self.iv  = iv
    def decrypt(self, enc):
        cipher = AES.new(self.key, AES.MODE_CBC, self.iv)
        return cipher.decrypt(enc)
        
data = base64.b64decode("YFaxYE39D6Ko6MDe6VuyIB006rlsxqgVEQW81PwRMQo=")
aes = AESCipher(data[0:16], data[16:])
f = open("challenge9.crypt", "rb")
content = f.read()[15:]
f.close()
result = aes.decrypt(content)
print result[0:128]
offset = 0
for i in range(len(result)-1):
    if result[i] == "P" and result[i+1] == "K":
        offset = i
        break
f = open("challenge9.zip", "wb")   
f.write(result[offset:])
f.close()